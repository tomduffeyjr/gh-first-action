name: List Artifacts

on:
  workflow_run:
    workflows: ["Track PR Number"]  # Trigger on completion of another workflow (can be changed)
    types:
      - completed

jobs:
  list-artifacts:
    runs-on: ubuntu-latest
    steps:
      # Set up GitHub CLI (gh)
      - name: Set up GitHub CLI
        uses: cli/gh-actions@v2

      # List artifacts available in the repository
      - name: List Artifacts
        env:
          GH_TOKEN: ${{ github.token }}  # Use GitHub token for authentication
        run: |
          # Fetch the list of artifacts
          ARTIFACTS=$(gh api repos/${{ github.repository }}/actions/artifacts --jq '.artifacts[].name')
          
          # Check if there are any artifacts and echo the list
          if [ -z "$ARTIFACTS" ]; then
            echo "No artifacts found."
          else
            echo "Available artifacts:"
            echo "$ARTIFACTS"
          fi
